/*! viewmachine 11-02-2014 */
if(void 0===ViewMachine)var ViewMachine={};if(ViewMachine=function(e){"use strict";var t;return t=function(i,r){var n,a,s,l,o,p;if("[object Array]"===Object.prototype.toString.call(i))for(n=0;i.length>n;n+=1)r.append(t(i[n],r));else if("string"==typeof i)e.makeElement(i);else for(a in i)if(i.hasOwnProperty(a)){switch(-1!==a.indexOf(":")&&(s=a.split(":")),l=void 0!==s?s[0]:a){case"div":o=e.makeElement(void 0!==s?s[0]:a,void 0!==s?s[1]:""),o.append(t(i[a],o));break;case"form":o=e.makeForm(i[a]);break;case"list":o=e.makeList(i[a]);break;case"table":o=e.makeTable(i[a].keyList,i[a].data);break;case"b":case"p":o=e.makeElement(void 0!==s?s[0]:a,void 0!==s?s[1]:""),"[object Array]"!==Object.prototype.toString.call(i[a])&&o.append(i[a]);break;case"img":o=["<img "+(void 0!==s?'class="'+s[1]+'" ':"")+'src="'+i[a]+'" '+(void 0!==s?'title="'+s[1]+'" ':"")+'alt="'+(void 0!==s?s[1]:i[a])+'" />'];break;case"h1":case"h2":case"h3":case"h4":o=e.makeElement(void 0!==s?s[0]:a,void 0!==s?s[1]:""),o.append(e.cleanTitles(i[a]));break;default:o=e.makeElement(void 0!==s?s[0]:a,void 0!==s?s[1]:""),o.append(p)}void 0!==o&&r.append(o)}return r},e.build=function(i){var r,n;return r=i.name,n=e.makeElement("div",r+" view"),n=t(i.structure,n)},e.example={name:"example",structure:[{h1:"The Title"},{div:{div:{p:'This is an <a href="#">example<a/> of paragraph text<br>squirted into a document with <b>inner HTML</b> '},form:e.exampleForm}},{"div:myClass":[{h3:"Sub-title"},{"p:green":"This is a list of paragraphs"}]}]},e}(ViewMachine),void 0===ViewMachine)var ViewMachine={};if(void 0===jQuery&&console.log("Please add JS dependecy jQuery before loading this file."),ViewMachine=function(e,t){"use strict";var i=[];return e.El=function(e,t){return this.element=e,void 0===t&&(t={}),t.id&&(this.id=t.id),this.drawn=!1,this.properties=t,this.children=[],this.events=[],this.style={},this},e.El.prototype={text:function(e){return this.properties.text=e,this.drawn&&this.draw(),this},getId:function(){return this.id?this.id:""+Math.floor(1e7*Math.random()+1)},HTML:function(e){this.drawn||(this.properties.id=this.getId()),e&&(this.drawn=!0);var r=t("<"+this.element+">",this.properties);for(var n in this.children)t(r).append(this.children[n].HTML(e));for(var a in this.events)this.events[a].id=this.properties.id,i.push(this.events[a]);return r},draw:function(){if(i=[],this.drawn)this.replace(this.HTML(!0));else{var e=this.HTML(!0);if("string"==typeof this.parent)t(this.parent).append(e),this.drawn=!0;else{if(this.parent.drawn!==!0)throw"DrawError: Parent element not on page";t("#"+this.parent.properties.id).append(e),this.drawn=!0}}for(var r=i.length,n=0;r>n;n++)t("#"+i[n].id).on(i[n].event,i[n].callback);return this},remove:function(){if(this.drawn&&(t("#"+this.properties.id).remove(),this.drawn=!1),this.properties.id=this.getId(),"string"!=typeof this.parent){this.getId();var e=this.parent.children;for(var i in e)e[i].properties.id===this.properties.id&&this.parent.children.splice(i,1)}return this},replace:function(e){return this.drawn?(t("#"+this.properties.id).replaceWith(e),this):void 0},hide:function(){return this.drawn&&(t("#"+this.properties.id).remove(),this.drawn=!1),this},append:function(e){return e.parent=this,this.children.push(e),this.drawn&&e.draw(),this},prepend:function(e){return e.parent=this,this.children=[e].concat(this.children),this.drawn&&this.draw(),this},splice:function(e,i,r){var n;if(r?(r.parent=this,n=this.children.splice(e,i,r),this.drawn&&(e>0?(t("#"+this.children[e-1].properties.id).after(r.HTML()),r.drawn=!0):(t("#"+this.properties.id).append(r.HTML()),r.drawn=!0))):n=this.children.splice(e,i),this.drawn)for(var a=n.length,s=0;a>s;s++)n[s].remove();return this},css:function(e,i){if("string"==typeof e){if(void 0===i)return r[i];this.style[e]=i}else this.style=e;var r="";for(var n in this.style)r+=n+": "+this.style[n]+"; ";return this.properties.style=r,this.drawn&&t("#"+this.properties.id).css(e,i),this},event:function(e,i){this.events.push({event:e,callback:i}),this.drawn&&t("#"+this.properties.id).on(e,i)},parent:"body",type:"ViewMachine"},e.ParentEl=function(t,i,r){var n,a,s=t;if(t.properties&&(a=t.properties,s=t.type),n=new e.El(s,a),"number"==typeof r)for(var l=0;r>l;l++)n.append(new e.El(i));else if(Array.isArray(r)){var o;for(var p in r)o="object"==typeof r[p]?"ViewMachine"===r[p].type?r[p]:new e.El(i,r[p]):new e.El(i,{text:r[p]}),n.append(o)}return n},e.List=function(t){var i="ul",r=t;return t.parent&&(i={type:"ul",properties:t.parent},r=t.children),e.ParentEl(i,"li",r)},e.Select=function(t){var i="select",r=t;return t.parent&&(i={type:"select",properties:t.parent},r=t.children),e.ParentEl(i,"option",r)},e.Table=function(i,r,n){var a,s,l=new e.El("table"),o=new e.El("thead"),p=new e.El("tbody"),c=i.length,d=n||i;o.append(new e.ParentEl("tr","th",d));for(var h in r)if(r.hasOwnProperty(h)){a=new e.El("tr");for(var m=0;c>m;m++)s=r[h][i[m]],Array.isArray(s)&&(s=s.join(", ")),a.append(new e.El("td",{text:s}));p.append(a)}return l.children.push(o),l.append(p),l.currentData={},t.extend(l.currentData,r),l.keys=i,l.data=function(t){var r,n=0,a=0,l={};for(var o in this.currentData)void 0===t[o]?a++:(a>0&&(this.children[1].splice(n,a),console.log(a)),n++,a=0);a>0&&this.children[1].splice(n,a),n=0;for(var p in t)if(t.hasOwnProperty(p)){if(l[p]=t[p],this.currentData.hasOwnProperty(p)){if(JSON.stringify(this.currentData[p])!==JSON.stringify(t[p]))for(var d=0;c>d;d++)t[p].hasOwnProperty(i[d])&&t[p][i[d]]!==this.currentData[p][i[d]]&&this.cell(n,d).text(t[p][i[d]])}else{r=new e.El("tr");for(var h=0;c>h;h++)t[p].hasOwnProperty(i[h])?(s=t[p][i[h]],Array.isArray(s)&&(s=s.join(", ")),r.append(new e.El("td",{text:s}))):r.append(new e.El("td"));this.children[1].splice(n,0,r)}n++}return this.currentData=l,this},l.cell=function(e,t){return this.children[1].children[e].children[t]},l},e.getKeys=function(t,i){var r,n,a,s,l={};for(n in i)if(i.hasOwnProperty(n))if("[object Array]"!==Object.prototype.toString.call(i[n])&&-1!==t.indexOf(n))if("object"==typeof i[n]){r=[];for(a in i[n])i[n].hasOwnProperty(a)&&r.push(a);l[n]=r.join(", "),s=e.getKeys(t,i[n]);for(a in s)s.hasOwnProperty(a)&&(l[a]=s[a])}else l[n]=i[n];else if(i.hasOwnProperty(n)&&"[object Array]"===Object.prototype.toString.call(i[n]))l[n]=i[n].join(", ");else if("object"==typeof i[n]){s=e.getKeys(t,i[n]);for(a in s)s.hasOwnProperty(a)&&(l[a]=s[a])}return l},e.createTemplate=function(t){var i={};if("object"==typeof t&&"ViewMachine"===t.type){i.style=t.style,i.element=t.element,i.id=t.id,i.properties={},i.children=[];for(var r in t.properties)"id"!==r&&(i.properties[r]=t.properties[r]);for(var n in t.children)"object"==typeof t&&"ViewMachine"===t.type&&i.children.push(e.createTemplate(t.children[n]));return i}return!1},e.construct=function(t){var i=new e.El(t.element,t.properties);for(var r in t.children)i.append(e.construct(t.children[r]));return i.style=t.style,i.id=t.id,i},e.jsonTemplate=function(t){if("string"==typeof t){var i=JSON.parse(t);return e.construct(i)}return"object"==typeof t&&"ViewMachine"===t.type&&(t=e.createTemplate(t)),JSON.stringify(t)},e}(ViewMachine,jQuery),void 0===ViewMachine)var ViewMachine={};if(void 0===jQuery)console.log("Please add JS dependecy jQuery before loading this file.");else var $=jQuery;ViewMachine=function(e){"use strict";return e.titles={example:"Example"},e.cleanTitles=function(e,t){var i,r;if(void 0!==t)return this.titles[e]=t,void 0;if(void 0===this.titles[e]&&e.length){for(r=e.toLowerCase().replace(/_/g," ").split(" "),i=0;r.length>i;i+=1)void 0!==this.titles[r[i]]&&(r[i]=this.titles[r[i]]),r[i]=r[i][0].toUpperCase()+r[i].substring(1);r=r.join(" ")}else r=e.length?this.titles[e]:e;return r},e.makeElement=function(e,t,i,r,n,a){var s,l,o,p;if(n=void 0!==n?n:"",r=void 0!==r?r:"",t=void 0!==t?t:"",p={},t.length&&(p["class"]=t),(r.length||n.length||"number"==typeof r||"number"==typeof n)&&(p.id=r+n),void 0!==i&&(null!==i&&19===i.length&&(s=i.replace(/\D/g," "),s=s.split(" "),6===s.length&&(i=new Date(s[0],s[1]-1,s[2],s[3],s[4],s[5]).toDateString())),p.text=i),l=$("<"+e+">",p),"object"==typeof a)for(o in a)a.hasOwnProperty(o)&&l.attr(o,a[o]);return l},e.makeList=function(t,i){var r,n,a,s,l,o;if(i=void 0!==i?i:e.makeElement("ul","list"),"[object Array]"!==Object.prototype.toString.call(t))for(r in t)t.hasOwnProperty(r)&&("object"!=typeof t[r]?(n=e.makeElement("li","item",t[r],r),i.append(n)):null!==t[r]&&(a=e.makeElement("ul",r.split(" ")[0]+" list"),i.append(a),n=e.makeElement("h3","title",e.cleanTitles(r)),a.append(n),e.makeList(t[r],a)));else if("object"!=typeof t[0])for(o=void 0!==i?i.attr("id"):"item",s=void 0!==i?i.attr("class"):"item",l=0;t.length>l;l+=1)n=e.makeElement("li",s,t[l],o,l+1),i.append(n);else for(l=0;t.length>l;l+=1)i.append(e.makeList(t[l],i));return i},e.makeCells=function(t,i,r){var n,a,s,l,o={};for(s in t)if(t.hasOwnProperty(s))if("object"!=typeof t[s]&&"[object Array]"!==Object.prototype.toString.call(t[s])&&-1!==r.indexOf(s))o[s]=null===t[s]?e.makeElement("td","none",""):e.makeElement("td",s,t[s]);else if("[object Array]"===Object.prototype.toString.call(t[s]))l=t[s].join(", "),o[s]=e.makeElement("td",s,l);else if("object"==typeof t[s]){n=e.makeCells(t[s],i,r);for(a in n)n.hasOwnProperty(a)&&(o[a]=n[a])}return o},e.makeTable=function(t,i){function r(t){return e.makeElement("tr",t)}var n,a,s,l,o,p,c;for(n=e.makeElement("table","classic"),o=r("title"),a=0;t.length>a;a+=1)s=e.cleanTitles(t[a]),o.append(e.makeElement("th",t[a],s));c=e.makeElement("thead"),c.append(o),n.append(c);for(l in i)if(i.hasOwnProperty(l)){for(o=r("row"),p=e.makeCells(i[l],o,t),a=0;t.length>a;a+=1)p.hasOwnProperty(t[a])?o.append(p[t[a]]):o.append(e.makeElement("td",t[a]+" none",""));n.append(o)}return n},e.makeForm=function(t){var i,r,n,a,s,l,o,p,c,d,h,m,f;for(i=void 0===t.fieldsetName?void 0!==t.formName?t.formName:"":t.fieldsetName,r=e.makeElement("fieldset",i),n=t.form,c=0;n.length>c;c+=1){switch(h=n[c].hasOwnProperty("name")?n[c].name:n[c].label,m=n[c].hasOwnProperty("cssClass")?n[c].cssClass:n[c].elementType,n[c].elementType){case"input":case"textarea":s=e.cleanTitles(n[c].label),r.append(e.makeElement("label",m,s+":","","",{"for":h})),l=["<"+n[c].elementType+' name="'+h+'"'+' id="'+h+'"'+" />"],r.append(l);break;case"checkbox":case"radio":for(d=0;n[c].options.length>d;d+=1)s=e.cleanTitles(n[c].options[d]),r.append(e.makeElement("label",m,s+":","","",{"for":n[c].options[d]})),f={type:n[c].elementType,name:"radio"===n[c].elementType?h:n[c].options[d]},f.value=void 0!==n[c].value?n[c].value[d]:n[c].options[d],n[c].selected===n[c].options[d]&&(f.checked="checked"),r.append(e.makeElement("input",m,"",n[c].options[d],"",f));break;case"select multiple":case"select":if(s=e.cleanTitles(n[c].label),r.append(e.makeElement("label",m,s+":","","",{"for":h})),a=e.makeElement("select",h,"",h,"","select multiple"===n[c].elementType?{multiple:"multiple"}:""),void 0!==n[c].options)for(d=0;n[c].options.length>d;d+=1)f={},f.value=void 0!==n[c].value?n[c].value[d]:n[c].options[d],n[c].selected===n[c].options[d]&&(f.selected="selected"),a.append(e.makeElement("option",m,n[c].options[d],f.value,"",f));r.append(a);break;case"button":s=e.cleanTitles(n[c].text),r.append(e.makeElement("button",m,s,h,"",{onclick:n[c].onclick}))}r.append("<br />")}return t.formName?(t.action&&t.formName&&(o={action:t.action,method:t.method}),p=e.makeElement("form",t.formName,"","","",o),p.append(r)):r},e.exampleForm={action:"",method:"",formName:"MyForm",fieldsetName:"myFields",form:[{name:"myField",label:"My Fav Textarea",elementType:"textarea",defaultText:"Prefill text...",cssClass:"customClass"},{name:"myField",label:"My Fav Textarea",elementType:"input",defaultText:"Prefill text..."},{label:"label2",elementType:"radio",options:["Male","Female"],selected:"Female",value:["m","f"]},{label:"label2",elementType:"checkbox",options:["Male","Female"],selected:"Female",value:["m","f"]},{name:"selectBox",label:"My Select Box",elementType:"select",options:["opt1","opt2","opt3"],selected:"opt2",value:[1,2,3]},{name:"selectBox2",label:"Same - No Values or selected specified",elementType:"select",options:["opt1","opt2","opt3"]},{name:"multipleSelect",label:"Same - No Values or selected specified",elementType:"select multiple",options:["opt1","opt2","opt3"]},{label:"myButton",elementType:"button",text:"Submit yourself!",onclick:"alert('I will not submit to you'); return false;"}]},e.exampleList=["Apples","Pears","Limes","Oranges","Plums"],e.exampleTable={keyList:["Apples","Pears","Limes","Oranges","Plums"],data:{fruits1:{Apples:10,Pears:20,Limes:100,Oranges:15,Plums:4},fruits2:{Apples:2,Pears:4,Limes:8,Oranges:16,Plums:32},fruits3:{Apples:64,Pears:128,Limes:256,Plums:1024}}},e}(ViewMachine);