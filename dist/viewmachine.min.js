/*! viewmachine 22-02-2014 */
if(void 0===ViewMachine)var ViewMachine={};if(ViewMachine=function(e){"use strict";var t;return t=function(r,i){var n,a,s,l,o,p;if("[object Array]"===Object.prototype.toString.call(r))for(n=0;r.length>n;n+=1)i.append(t(r[n],i));else if("string"==typeof r)e.makeElement(r);else for(a in r)if(r.hasOwnProperty(a)){switch(-1!==a.indexOf(":")&&(s=a.split(":")),l=void 0!==s?s[0]:a){case"div":o=e.makeElement(void 0!==s?s[0]:a,void 0!==s?s[1]:""),o.append(t(r[a],o));break;case"form":o=e.makeForm(r[a]);break;case"list":o=e.makeList(r[a]);break;case"table":o=e.makeTable(r[a].keyList,r[a].data);break;case"b":case"p":o=e.makeElement(void 0!==s?s[0]:a,void 0!==s?s[1]:""),"[object Array]"!==Object.prototype.toString.call(r[a])&&o.append(r[a]);break;case"img":o=["<img "+(void 0!==s?'class="'+s[1]+'" ':"")+'src="'+r[a]+'" '+(void 0!==s?'title="'+s[1]+'" ':"")+'alt="'+(void 0!==s?s[1]:r[a])+'" />'];break;case"h1":case"h2":case"h3":case"h4":o=e.makeElement(void 0!==s?s[0]:a,void 0!==s?s[1]:""),o.append(e.cleanTitles(r[a]));break;default:o=e.makeElement(void 0!==s?s[0]:a,void 0!==s?s[1]:""),o.append(p)}void 0!==o&&i.append(o)}return i},e.build=function(r){var i,n;return i=r.name,n=e.makeElement("div",i+" view"),n=t(r.structure,n)},e.example={name:"example",structure:[{h1:"The Title"},{div:{div:{p:'This is an <a href="#">example<a/> of paragraph text<br>squirted into a document with <b>inner HTML</b> '},form:e.exampleForm}},{"div:myClass":[{h3:"Sub-title"},{"p:green":"This is a list of paragraphs"}]}]},e}(ViewMachine),void 0===ViewMachine)var ViewMachine={compatability:!1};if(void 0===jQuery&&console.log("Please add JS dependecy jQuery before loading this file."),!ViewMachine.compatability)var VM=ViewMachine;if(ViewMachine=function(e,t){"use strict";var r=[];return e.El=function(e,t){return this.element=e,void 0===t&&(t={}),t.id&&(this.id=t.id),this.drawn=!1,this.properties=t,this.children=[],this.events=[],this.style={},this},e.El.prototype={text:function(e){return this.properties.text=e,this.drawn&&this.draw(),this},getId:function(){return this.id?this.id:""+Math.floor(1e7*Math.random()+1)},html:function(e){this.drawn||(this.properties.id=this.getId()),e&&(this.drawn=!0);var i=t("<"+this.element+">",this.properties);i.css(this.style);for(var n=this.children.length,a=0;n>a;a++)t(i).append(this.children[a].html(e));for(var s in this.events)this.events[s].id=this.properties.id,r.push([this.events[s],this]);return i},$:function(){return this.drawn?t("#"+this.properties.id):this.html()},draw:function(){function i(r,i,n,a){t("#"+r).on(i,function(r){t(e).trigger(n,[r,a])})}if(r=[],this.drawn)this.replace(this.html(!0));else{var n=this.html(!0);if("string"==typeof this.parent)t(this.parent).append(n),this.drawn=!0;else{if(this.parent.drawn!==!0)throw"DrawError: Parent element not on page";t("#"+this.parent.properties.id).append(n),this.drawn=!0}}for(var a=r.length,s=0;a>s;s++)"function"==typeof r[s][0].callback?t("#"+r[s][0].id).on(r[s][0].event,r[s][1],r[s][0].callback):i(r[s][0].id,r[s][0].event,r[s][0].callback,r[s][1]);return this},remove:function(){if(this.drawn&&(t("#"+this.properties.id).remove(),this.drawn=!1),this.properties.id=this.getId(),"string"!=typeof this.parent){this.getId();for(var e=this.parent.children,r=e.length,i=0;r>i;i++)e[i].properties.id===this.properties.id&&this.parent.children.splice(i,1)}return this},replace:function(e){return this.drawn?(t("#"+this.properties.id).replaceWith(e),this):void 0},hide:function(){return this.drawn&&(t("#"+this.properties.id).remove(),this.drawn=!1),this},append:function(e){return e.parent=this,this.children.push(e),this.drawn&&e.draw(),this},prepend:function(e){return e.parent=this,this.children=[e].concat(this.children),this.drawn&&this.draw(),this},splice:function(e,r,i){var n;if(i?(i.parent=this,n=this.children.splice(e,r,i),this.drawn&&(e>0?(t("#"+this.children[e-1].properties.id).after(i.html()),i.drawn=!0):(t("#"+this.properties.id).append(i.html()),i.drawn=!0))):n=this.children.splice(e,r),this.drawn)for(var a=n.length,s=0;a>s;s++)n[s].remove();return this},css:function(e,r){if("string"==typeof e){if(void 0===r)return this.style[r];this.style[e]=r,this.drawn&&t("#"+this.properties.id).css(e,r)}else{this.drawn&&t("#"+this.properties.id).css(e);for(var i in e)this.style[i]=e[i]}return this},event:function(r,i){this.events.push({event:r,callback:i});var n=this;"function"==typeof i?this.drawn&&t("#"+this.properties.id).on(r,this,i):"string"==typeof i&&this.drawn&&t("#"+this.properties.id).on(r,function(r){t(e).trigger(i,[r,n])})},parent:"body",type:"ViewMachine"},e.ParentEl=function(t,r,i){var n,a,s=t;if(t.properties&&(a=t.properties,s=t.type),n=new e.El(s,a),"number"==typeof i)for(var l=0;i>l;l++)n.append(new e.El(r));else if(Array.isArray(i))for(var o,p=i.length,c=0;p>c;c++)o="object"==typeof i[c]?"ViewMachine"===i[c].type?i[c]:new e.El(r,i[c]):new e.El(r,{text:i[c]}),n.append(o);return n},e.getKeys=function(t,r){var i,n,a,s,l={};for(n in r)if(r.hasOwnProperty(n))if("[object Array]"!==Object.prototype.toString.call(r[n])&&-1!==t.indexOf(n))if("object"==typeof r[n]){i=[];for(a in r[n])r[n].hasOwnProperty(a)&&i.push(a);l[n]=i.join(", "),s=e.getKeys(t,r[n]);for(a in s)s.hasOwnProperty(a)&&(l[a]=s[a])}else l[n]=r[n];else if(r.hasOwnProperty(n)&&"[object Array]"===Object.prototype.toString.call(r[n]))l[n]=r[n].join(", ");else if("object"==typeof r[n]){s=e.getKeys(t,r[n]);for(a in s)s.hasOwnProperty(a)&&(l[a]=s[a])}return l},e.createTemplate=function(r){var i={};if("object"==typeof r&&"ViewMachine"===r.type){if(i.element=r.element,t.isEmptyObject(r.style)||(i.style=r.style),void 0!==r.id&&(i.id=r.id),!t.isEmptyObject(r.properties))for(var n in r.properties)void 0!==r.properties[n]&&"id"!==n&&(i.properties=i.properties||{},i.properties[n]=r.properties[n]);if(!r.children.length||void 0!==r.preserve&&r.preserve!==!0)r.preserve===!1&&(i.preserve=!1);else{i.children=[];for(var a in r.children)"object"==typeof r&&"ViewMachine"===r.type&&i.children.push(e.createTemplate(r.children[a]))}if(e.properties[r.element])for(var s in e.properties[r.element])"object"==typeof r[e.properties[r.element][s]]?(i[e.properties[r.element][s]]=Array.isArray(r[e.properties[r.element][s]])?[]:{},t.extend(i[e.properties[r.element][s]],r[e.properties[r.element][s]])):i[e.properties[r.element][s]]=r[e.properties[r.element][s]];if(r.events.length){i.events=[];for(var l in r.events)"string"==typeof r.events[l].callback&&i.events.push({event:r.events[l].event,callback:r.events[l].callback})}return i}return!1},e.construct=function(r){var i;if(r.preserve===!1)i=new(e[r.element.substring(0,1).toUpperCase()+r.element.substring(1,r.element.length)])(r[e.properties[r.element][0]],r[e.properties[r.element][1]],r[e.properties[r.element][2]],r[e.types[r.element][3]]);else{if(i="img"===r.element&&"string"==typeof r.preload?new e.Image(r.src,r.preload,r.properties):new e.El(r.element,r.properties),e.properties[i.element])for(var n in e.properties[i.element])"object"==typeof i[e.properties[i.element][n]]?(i[e.properties[i.element][n]]={},t.extend(i[e.properties[i.element][n]],r[e.properties[i.element][n]])):i[e.properties[i.element][n]]=r[e.properties[i.element][n]];e.types[i.element]&&t.extend(i,e.types[i.element])}for(var a in r.children)i.append(e.construct(r.children[a]));return r.style&&(i.style=r.style),void 0!==r.id&&(i.id=r.id),void 0!==r.events&&(i.events=r.events),i},e.jsonTemplate=function(t){if("string"==typeof t){var r=JSON.parse(t);return e.construct(r)}return"object"==typeof t&&"ViewMachine"===t.type&&(t=e.createTemplate(t)),JSON.stringify(t)},e}(ViewMachine,jQuery),void 0===ViewMachine)var ViewMachine={};if(void 0===jQuery)console.log("Please add JS dependecy jQuery before loading this file.");else var $=jQuery;if(ViewMachine=function(e){"use strict";return e.titles={example:"Example"},e.cleanTitles=function(e,t){var r,i;if(void 0!==t)return this.titles[e]=t,void 0;if(void 0===this.titles[e]&&e.length){for(i=e.toLowerCase().replace(/_/g," ").split(" "),r=0;i.length>r;r+=1)void 0!==this.titles[i[r]]&&(i[r]=this.titles[i[r]]),i[r]=i[r][0].toUpperCase()+i[r].substring(1);i=i.join(" ")}else i=e.length?this.titles[e]:e;return i},e.makeElement=function(e,t,r,i,n,a){var s,l,o,p;if(n=void 0!==n?n:"",i=void 0!==i?i:"",t=void 0!==t?t:"",p={},t.length&&(p["class"]=t),(i.length||n.length||"number"==typeof i||"number"==typeof n)&&(p.id=i+n),void 0!==r&&(null!==r&&19===r.length&&(s=r.replace(/\D/g," "),s=s.split(" "),6===s.length&&(r=new Date(s[0],s[1]-1,s[2],s[3],s[4],s[5]).toDateString())),p.text=r),l=$("<"+e+">",p),"object"==typeof a)for(o in a)a.hasOwnProperty(o)&&l.attr(o,a[o]);return l},e.makeList=function(t,r){var i,n,a,s,l,o;if(r=void 0!==r?r:e.makeElement("ul","list"),"[object Array]"!==Object.prototype.toString.call(t))for(i in t)t.hasOwnProperty(i)&&("object"!=typeof t[i]?(n=e.makeElement("li","item",t[i],i),r.append(n)):null!==t[i]&&(a=e.makeElement("ul",i.split(" ")[0]+" list"),r.append(a),n=e.makeElement("h3","title",e.cleanTitles(i)),a.append(n),e.makeList(t[i],a)));else if("object"!=typeof t[0])for(o=void 0!==r?r.attr("id"):"item",s=void 0!==r?r.attr("class"):"item",l=0;t.length>l;l+=1)n=e.makeElement("li",s,t[l],o,l+1),r.append(n);else for(l=0;t.length>l;l+=1)r.append(e.makeList(t[l],r));return r},e.makeCells=function(t,r,i){var n,a,s,l,o={};for(s in t)if(t.hasOwnProperty(s))if("object"!=typeof t[s]&&"[object Array]"!==Object.prototype.toString.call(t[s])&&-1!==i.indexOf(s))o[s]=null===t[s]?e.makeElement("td","none",""):e.makeElement("td",s,t[s]);else if("[object Array]"===Object.prototype.toString.call(t[s]))l=t[s].join(", "),o[s]=e.makeElement("td",s,l);else if("object"==typeof t[s]){n=e.makeCells(t[s],r,i);for(a in n)n.hasOwnProperty(a)&&(o[a]=n[a])}return o},e.makeTable=function(t,r){function i(t){return e.makeElement("tr",t)}var n,a,s,l,o,p,c;for(n=e.makeElement("table","classic"),o=i("title"),a=0;t.length>a;a+=1)s=e.cleanTitles(t[a]),o.append(e.makeElement("th",t[a],s));c=e.makeElement("thead"),c.append(o),n.append(c);for(l in r)if(r.hasOwnProperty(l)){for(o=i("row"),p=e.makeCells(r[l],o,t),a=0;t.length>a;a+=1)p.hasOwnProperty(t[a])?o.append(p[t[a]]):o.append(e.makeElement("td",t[a]+" none",""));n.append(o)}return n},e.makeForm=function(t){var r,i,n,a,s,l,o,p,c,d,h,m,f;for(r=void 0===t.fieldsetName?void 0!==t.formName?t.formName:"":t.fieldsetName,i=e.makeElement("fieldset",r),n=t.form,c=0;n.length>c;c+=1){switch(h=n[c].hasOwnProperty("name")?n[c].name:n[c].label,m=n[c].hasOwnProperty("cssClass")?n[c].cssClass:n[c].elementType,n[c].elementType){case"input":case"textarea":s=e.cleanTitles(n[c].label),i.append(e.makeElement("label",m,s+":","","",{"for":h})),l=["<"+n[c].elementType+' name="'+h+'"'+' id="'+h+'"'+" />"],i.append(l);break;case"checkbox":case"radio":for(d=0;n[c].options.length>d;d+=1)s=e.cleanTitles(n[c].options[d]),i.append(e.makeElement("label",m,s+":","","",{"for":n[c].options[d]})),f={type:n[c].elementType,name:"radio"===n[c].elementType?h:n[c].options[d]},f.value=void 0!==n[c].value?n[c].value[d]:n[c].options[d],n[c].selected===n[c].options[d]&&(f.checked="checked"),i.append(e.makeElement("input",m,"",n[c].options[d],"",f));break;case"select multiple":case"select":if(s=e.cleanTitles(n[c].label),i.append(e.makeElement("label",m,s+":","","",{"for":h})),a=e.makeElement("select",h,"",h,"","select multiple"===n[c].elementType?{multiple:"multiple"}:""),void 0!==n[c].options)for(d=0;n[c].options.length>d;d+=1)f={},f.value=void 0!==n[c].value?n[c].value[d]:n[c].options[d],n[c].selected===n[c].options[d]&&(f.selected="selected"),a.append(e.makeElement("option",m,n[c].options[d],f.value,"",f));i.append(a);break;case"button":s=e.cleanTitles(n[c].text),i.append(e.makeElement("button",m,s,h,"",{onclick:n[c].onclick}))}i.append("<br />")}return t.formName?(t.action&&t.formName&&(o={action:t.action,method:t.method}),p=e.makeElement("form",t.formName,"","","",o),p.append(i)):i},e.exampleForm={action:"",method:"",formName:"MyForm",fieldsetName:"myFields",form:[{name:"myField",label:"My Fav Textarea",elementType:"textarea",defaultText:"Prefill text...",cssClass:"customClass"},{name:"myField",label:"My Fav Textarea",elementType:"input",defaultText:"Prefill text..."},{label:"label2",elementType:"radio",options:["Male","Female"],selected:"Female",value:["m","f"]},{label:"label2",elementType:"checkbox",options:["Male","Female"],selected:"Female",value:["m","f"]},{name:"selectBox",label:"My Select Box",elementType:"select",options:["opt1","opt2","opt3"],selected:"opt2",value:[1,2,3]},{name:"selectBox2",label:"Same - No Values or selected specified",elementType:"select",options:["opt1","opt2","opt3"]},{name:"multipleSelect",label:"Same - No Values or selected specified",elementType:"select multiple",options:["opt1","opt2","opt3"]},{label:"myButton",elementType:"button",text:"Submit yourself!",onclick:"alert('I will not submit to you'); return false;"}]},e.exampleList=["Apples","Pears","Limes","Oranges","Plums"],e.exampleTable={keyList:["Apples","Pears","Limes","Oranges","Plums"],data:{fruits1:{Apples:10,Pears:20,Limes:100,Oranges:15,Plums:4},fruits2:{Apples:2,Pears:4,Limes:8,Oranges:16,Plums:32},fruits3:{Apples:64,Pears:128,Limes:256,Plums:1024}}},e}(ViewMachine),void 0===ViewMachine)var ViewMachine={};ViewMachine=function(e,t){"use strict";return e.types=e.types||{},e.properties=e.properties||{},e.List=function(t){var r="ul",i=t;return t.parent&&(r={type:"ul",properties:t.parent},i=t.children),e.ParentEl(r,"li",i)},e.Select=function(t){var r="select",i=t;return t.parent&&(r={type:"select",properties:t.parent},i=t.children),e.ParentEl(r,"option",i)},e.Table=function(r,i,n){var a,s,l=new e.El("table"),o=new e.El("thead"),p=new e.El("tbody"),c=i.length,d=n||i;l.currentHeadings=d,o.append(new e.ParentEl("tr","th",d));for(var h in r)if(r.hasOwnProperty(h)){a=new e.El("tr");for(var m=0;c>m;m++)s=r[h][i[m]],Array.isArray(s)&&(s=s.join(", ")),a.append(new e.El("td",{text:s}));p.append(a)}return l.children.push(o),l.append(p),l.currentData={},l.preserve=!1,t.extend(l.currentData,r),l.keys=i,t.extend(l,e.types.table),l},e.properties.table=["currentData","keys","currentHeadings"],e.types.table={data:function(t){var r,i,n=this.keys.length,a=0,s=0,l={};for(var o in this.currentData)void 0===t[o]?s++:(s>0&&this.children[1].splice(a,s),a++,s=0);s>0&&this.children[1].splice(a,s),a=0;for(var p in t)if(t.hasOwnProperty(p)){if(l[p]=t[p],this.currentData.hasOwnProperty(p)){if(JSON.stringify(this.currentData[p])!==JSON.stringify(t[p]))for(var c=0;n>c;c++)t[p].hasOwnProperty(keys[c])&&t[p][keys[c]]!==this.currentData[p][this.keys[c]]&&this.cell(a,c).text(t[p][this.keys[c]])}else{r=new e.El("tr");for(var d=0;n>d;d++)t[p].hasOwnProperty(this.keys[d])?(i=t[p][this.keys[d]],Array.isArray(i)&&(i=i.join(", ")),r.append(new e.El("td",{text:i}))):r.append(new e.El("td"));this.children[1].splice(a,0,r)}a++}return this.currentData=l,this},headings:function(r,i){this.currentHeadings=i||r;var n={};return t.extend(n,this.currentData),this.children[0].splice(0,1,new e.ParentEl("tr","th",this.currentHeadings)),this.data([]),this.keys=r,this.data(n),this},cell:function(e,t){return this.children[1].children[e].children[t]}},e.Video=function(t,r,i){var n=new e.El("video",i);for(var a in t)n.append(new e.El("source",{src:r+"."+t[a],type:"video/"+t[a]}));return n},e.Image=function(t,r,i){var n=new e.El("img",{src:r,"data-img":t});n.preload=r,n.src=t;for(var a in i)n.properties[a]=i[a];var s=new Image;return s.onload=function(){n.properties.src=n.properties["data-img"],n.drawn&&n.draw()},s.src=t,n},e.properties.img=["src","preload"],e}(ViewMachine,jQuery);