/*! viewmachine 18-05-2014 */
function Template(e){this.DOM=e.apply(this)}viewMachine=function(e,t,i){return new viewMachine.init(e,t,i)},viewMachine.init=function(e,t,i){var n;if(e instanceof HTMLElement==!0){if(n=e,void 0!==n.VM)return n.VM.attrs(t),n.VM.css(i),n.VM}else{if("string"!=typeof e)throw"Value Error: element must be eith an HTMLElement, or a string of an HTMLElement";n="body"!==e.toLowerCase()?document.createElement(e):document.body}return this.$=n,n.VM=this,this.element=n.tagName,this.attrs(t),this.css(i),this},null===window.onload?window.onload=function(){viewMachine.body=viewMachine(document.body)}:null===document.onload&&(document.onload=function(){viewMachine.body=viewMachine(document.body)}),viewMachine.init.prototype=viewMachine.prototype,window.viewMachine=window.VM=viewMachine,viewMachine.prototype.attrs=function(e,t){if("object"==typeof e)for(var i in e)this.$.setAttribute(i,e[i]);else if("string"==typeof e&&void 0!==t)this.$.setAttribute(e,t);else if(void 0!==e)return this.$.getAttribute(e);return this},viewMachine.prototype.getAllAttrs=function(){for(var e=this.$.attributes,t={},i=0;e.length>i;i++)t[e[i].name]=e[i].value;return t},viewMachine.prototype.addClass=function(e){var t;return t=this.properties["class"]?this.properties["class"].split(" "):[],-1===t.indexOf(e)&&(t.push(e),this.properties["class"]=t.join(" "),this.drawn&&document.getElementById(this.properties.id).setAttribute("class",this.properties["class"])),this},viewMachine.prototype.removeClass=function(e){var t=this.properties["class"].split(" "),i=t.indexOf(e);return i>=0&&(t.splice(i,1),this.properties["class"]=t.join(" "),this.drawn&&document.getElementById(this.properties.id).setAttribute("class",this.properties["class"])),this},viewMachine.prototype.css=function(e,t){if("string"==typeof e){if(void 0===t)return this.drawn?getComputedStyle(document.getElementById(this.properties.id))[e]:this.style[e]||"";this.style[e]=t,this.drawn&&(document.getElementById(this.properties.id).style[e]=t)}else for(var i in e)this.style[i]=e[i],this.drawn&&(document.getElementById(this.properties.id).style[i]=e[i]);return this},viewMachine.prototype.parent=function(){return this.$.parentNode},viewMachine.prototype.children=function(){return this.$.children},viewMachine.prototype.remove=function(){if(this.drawn){var e=document.getElementById(this.properties.id);e&&e.parentNode.removeChild(e),this.drawn=!1}else this.properties.id||(this.properties.id=this.getId());if("string"!=typeof this.parent)for(var t=this.parent.children,i=t.length,n=0;i>n;n++)if(t[n].properties.id===this.properties.id)return this.parent.children.splice(n,1),this;return this},viewMachine.prototype.replace=function(e){return this.drawn?(document.getElementById(this.properties.id).outerHTML=e,this):void 0},viewMachine.prototype.hide=function(){if(this.drawn){var e=document.getElementById(this.properties.id);e.parentNode.removeChild(e),this.drawn=!1}return this},viewMachine.prototype.append=function(e){return this.$.appendChild(e.$),this},viewMachine.prototype.mappend=function(e){if("object"==typeof e)for(var t in e)this.append(e[t]);else for(var i=0;e.length>i;i++)this.append(e[i]);return this},viewMachine.prototype.prepend=function(e){return e.parent=this,this.children=[e].concat(this.children),this.drawn&&this.draw(),this},viewMachine.prototype.splice=function(e,t,i){var n;if(i){i.parent=this,n=this.children.splice(e,t,i);try{if(this.drawn&&void 0!==i)if(e>0){var r=document.getElementById(this.children[e-1].properties.id);r?r.insertAdjacentHTML("afterend",i.html(!0).outerHTML):this.append(i),i.drawn=!0}else document.getElementById(this.properties.id).appendChild(i.html(!0)),i.drawn=!0}catch(a){this.parent.draw()}}else n=this.children.splice(e,t);if(this.drawn)for(var s=n.length,h=0;s>h;h++)n[h].remove();return this},viewMachine.prototype.text=function(e){return this.properties.text=e,this},viewMachine.trim=function(e,t,i){return e.length>=t&&(e=e.substring(0,t)),i?e+i:e},viewMachine.events={},viewMachine.addEventListener=function(e,t,i){e.addEventListener?e.addEventListener(t,i):e.attachEvent("on"+t,i)},viewMachine.on=function(e,t,i){if("string"!=typeof e||"function"!=typeof t)throw"Type Error: viewMachine.on expects, (string, function)";void 0===viewMachine.event[e]&&(viewMachine.event[e]=[]),viewMachine.event[e].push([t,i])},viewMachine.trigger=function(e,t){if(void 0!==viewMachine.event[e])for(var i={event:e,timestamp:(new Date).getTime()},n=0;viewMachine.event[e].length>n;n++)2===viewMachine.event[e][n].length&&(i.data=viewMachine.event[e][n][1]),viewMachine.event[e][n][0](i,t)},viewMachine.removeAllListeners=function(e){void 0!==viewMachine.event[e]&&delete viewMachine.event[e]},viewMachine.prototype.event=function(e,t){if(this.events.push({event:e,callback:t}),"function"==typeof t)this.drawn&&viewMachine.addEventListener(document.getElementById(this.properties.id),e,function(e){e.data=this,t(e)});else if("string"==typeof t&&this.drawn){var i=this;viewMachine.addEventListener(document.getElementById(this.properties.id),e,function(){viewMachine.trigger(t,i)})}return this},viewMachine.crunch=function(e){for(var t=viewMachine(e),i=t.children(),n=i.length,r=0;n>r;r++)viewMachine.crunch(i[r]);return t},viewMachine.extend=function(e){e=e||{};for(var t=1;arguments.length>t;t++){var i=arguments[t];if(i){if(Array.isArray(i)){e=[];for(var n=0;i.length>n;n++)"object"==typeof i[n]?(e.push({}),viewMachine.extend(e[t],i[t])):e.push(i[t])}for(var r in i)i.hasOwnProperty(r)&&("object"==typeof i[r]?viewMachine.extend(e[r],i[r]):e[r]=i[r])}}return e};var h=Object.prototype.hasOwnProperty;viewMachine.isEmpty=function(e){if(null===e)return!0;if(e.length>0)return!1;if(0===e.length)return!0;for(var t in e)if(h.call(e,t))return!1;return!0},viewMachine.schonfinkelize=function(e){var t=Array.prototype.slice,i=t.call(arguments,1);return function(){var n=t.call(arguments),r=i.concat(n);return e.apply(null,r)}},viewMachine.parent=function(e,t,i){var n,r,a=e;if(e.properties&&(r=e.properties,a=e.type),n=new viewMachine.init(a,r),"number"==typeof i)for(var s=0;i>s;s++)n.append(new viewMachine.init(t));else if(Array.isArray(i))for(var h,c=i.length,o=0;c>o;o++)h="object"==typeof i[o]?"ViewMachine"===i[o].type?i[o]:new viewMachine.init(t,i[o]):new viewMachine.init(t,{text:i[o]}),n.append(h);return n},viewMachine.types=viewMachine.types||{},viewMachine.properties=viewMachine.properties||{},viewMachine.List=function(e){var t="ul",i=e;return e.parent&&(t={type:"ul",properties:e.parent},i=e.children),viewMachine.parent(t,"li",i)},viewMachine.Select=function(e){var t="select",i=e;return e.parent&&(t={type:"select",properties:e.parent},i=e.children),viewMachine.parent(t,"option",i)},viewMachine.Table=function(e,t,i){var n,r,a=viewMachine("table"),s=viewMachine("thead"),c=viewMachine("tbody"),o=t.length,p=i||t;a.currentHeadings=p,s.append(new viewMachine.parent("tr","th",p));for(var d in e)if(h.call(e,d)){n=viewMachine("tr");for(var v=0;o>v;v++)r=e[d][t[v]],Array.isArray(r)&&(r=r.join(", ")),n.append(viewMachine("td",{text:r}));c.append(n)}return a.children.push(s),a.append(c),a.preserve=!1,a.keys=t,viewMachine.extend(a,viewMachine.types.table),a.currentData={},a.currentData=viewMachine.extend(a.currentData,e),a},viewMachine.properties.table=["currentData","keys","currentHeadings"],viewMachine.types.table={data:function(e){var t,i=this.keys.length;t=Array.isArray(e)?[]:{};var n,r,a=0,s=0;for(var c in this.currentData)void 0===e[c]?s++:(s>0&&this.children[1].splice(a,s),a++,s=0);s>0&&this.children[1].splice(a,s),a=0;for(var o in e)if(h.call(e,o)){if(t[o]=e[o],h.call(this.currentData,o)){if(JSON.stringify(this.currentData[o])!==JSON.stringify(e[o]))for(var p=0;i>p;p++)h.call(e[o],this.keys[p])&&e[o][this.keys[p]]!==this.currentData[o][this.keys[p]]&&this.cell(a,p).text(e[o][this.keys[p]])}else{n=viewMachine("tr");for(var d=0;i>d;d++)h.call(e[o],this.keys[d])?(r=e[o][this.keys[d]],Array.isArray(r)&&(r=r.join(", ")),n.append(viewMachine("td",{text:r}))):n.append(viewMachine("td"));this.children[1].splice(a,0,n)}a++}return this.currentData=t,this},headings:function(e,t){this.currentHeadings=t||e;var i={};return i=viewMachine.extend(i,this.currentData),this.children[0].splice(0,1,new viewMachine.parent("tr","th",this.currentHeadings)),this.data([]),this.keys=e,this.data(i),this},cell:function(e,t){return this.children[1].children[e].children[t]}},viewMachine.Video=function(e,t,i){var n=viewMachine("video",i);for(var r in e)n.append(viewMachine("source",{src:t+"."+e[r],type:"video/"+e[r]}));return n},viewMachine.Image=function(e,t,i){var n=viewMachine("img",{src:t,"data-img":e});n.preload=t,n.src=e;for(var r in i)n.properties[r]=i[r];var a=new Image;return a.onload=function(){n.properties.src=n.properties["data-img"],n.drawn&&n.draw()},a.src=e,n},viewMachine.properties.img=["src","preload"],Template.prototype.ref=function(e,t){this.refs=this.refs||{},this.refs[e]=t},Template.prototype.dataHandler=function(e,t,i){this.data=this.data||{},this.data[e]=viewMachine.schonfinkelize(i,t)},viewMachine.Gen=function(e){this.build=function(){return new Template(e)}};